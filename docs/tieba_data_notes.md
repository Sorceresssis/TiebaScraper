# è´´å§æ•°æ®ç¬”è®°

## User

### ç”¨æˆ·å”¯ä¸€æ ‡è¯†

**user_id**

å¯èƒ½ä¸ºç©ºï¼Œä¸Šå¤ipç”¨æˆ·æ²¡æœ‰user_id.

user_id å¯èƒ½ä¸å­˜åœ¨

`https://github.com/Starry-OvO/aiotieba/issues/213#issuecomment-2241636224`

**portrait**

ä¸€å®šä¸ä¸ºç©º, å¾ˆé‡è¦çš„å‚æ•°ã€‚

æœ‰å¤šä¸ªç‰ˆæœ¬ã€‚

**username**

å¯èƒ½ä¸ºç©ºï¼Œæ—©æœŸäº’è”ç½‘éœ€è¦å¡«å†™ç”¨æˆ·åã€‚ä½†æ˜¯ç°åœ¨å¾ˆå¤šè´¦å·æ²¡æœ‰ç”¨æˆ·åã€‚

post ä¼šä¿å­˜ä¸€äº›å…³äºç”¨æˆ·çš„å†—ä½™å­—æ®µã€‚ä¼šä¿ç•™ä¸€äº›è¢« `-` ä»£æ›¿çš„ç”¨æˆ·åã€‚

æ¥å£è¯·æ±‚åˆ°çš„ username æ˜¯ç»è¿‡å¤„ç†çš„ã€‚

1. ç”µè¯å·ç ç±»

ç”µè¯å·ç ä¼šè¢«éšç§å¤„ç†: `133******37`

```json
{
    "user_id": 1371763488,
    "portrait": "tb.1.e67e027b.vYbye7MZFu33wtZGvHLLdg",
    "user_name": "-",
    "nick_name_new": "ç’æ‘æƒ‚é¢ã„¦åŸ›_QA3J3KSé¦ƒæƒ¥",
    "tieba_uid": 0,
    "glevel": 0,
    "gender": 1,
    "age": 9.9,
    "post_num": 1304,
    "agree_num": 0,
    "fan_num": 29,
    "follow_num": 15,
    "forum_num": 108,
    "sign": "æ–°ç”Ÿçš„BIGER",
    "ip": "",
    "icons": ["wxshen", "wxxian", "wxyao"],
    "vimage": { "enabled": false, "state": "" },
    "is_vip": false,
    "is_god": false,
    "is_blocked": false,
    "priv_like": 3,
    "priv_reply": 1
}
```

2. æ•æ„Ÿå­—, ä¼šè¢«ç”¨ `-` ç¬¦å·ä»£æ›¿ã€‚

`ä½ éº»ç—¹972`

```json
{
    "user_id": 1164702015,
    "portrait": "tb.1.8b4d3d91.a4jtPwNaT61v33tAzAFOTA",
    "user_name": "-",
    "nick_name_new": "è´´å§ç”¨æˆ·_Q7Me34C",
    "tieba_uid": 0,
    "glevel": 0,
    "gender": 1,
    "age": 9.2,
    "post_num": 2612,
    "agree_num": 6,
    "fan_num": 85,
    "follow_num": 12,
    "forum_num": 9,
    "sign": "æ€ªæˆ‘å’¯ã€‚",
    "ip": "",
    "icons": [],
    "vimage": { "enabled": false, "state": "" },
    "is_vip": false,
    "is_god": false,
    "is_blocked": false,
    "priv_like": 3,
    "priv_reply": 1
}
```

`X1NPJ`

```json
{
    "user_id": 1604997478,
    "portrait": "tb.1.726db229.anu5OjnVZiPVETH8_E6VQg",
    "user_name": "-",
    "nick_name_new": "ä¸‡å¿—ç¿”",
    "tieba_uid": 1134632183,
    "glevel": 2,
    "gender": 1,
    "age": 9.4,
    "post_num": 1233,
    "agree_num": 715,
    "fan_num": 0,
    "follow_num": 0,
    "forum_num": 0,
    "sign": "",
    "ip": "å†…è’™å¤",
    "icons": [],
    "vimage": { "enabled": false, "state": "" },
    "is_vip": false,
    "is_god": false,
    "is_blocked": false,
    "priv_like": 1,
    "priv_reply": 1
}
```

`è´´å§ç”¨æˆ·_0002VDbğŸ¾`

```json
{
    "user_id": 579507,
    "portrait": "tb.1.25502702.BrAM9CZAwzNgOWADvgm_JQ",
    "user_name": "-",
    "nick_name_new": "è´´å§ç”¨æˆ·_0002VDbğŸ¾",
    "tieba_uid": 10243430,
    "glevel": 0,
    "gender": 2,
    "age": 19.9,
    "post_num": 671826,
    "agree_num": 948,
    "fan_num": 48,
    "follow_num": 0,
    "forum_num": 216,
    "sign": "ä¸åŒçš„äººåœ¨ç”¨åˆ«ææ··å•¦",
    "ip": "",
    "icons": [],
    "vimage": { "enabled": false, "state": "" },
    "is_vip": false,
    "is_god": false,
    "is_blocked": false,
    "priv_like": 3,
    "priv_reply": 1
}
```

`ç™¾åº¦ç”¨æˆ·#981758301`

```json
{
    "user_id": 811989719,
    "portrait": "tb.1.e1543ca9.sIAxKFosukK97_rHsI4fKw",
    "user_name": "-",
    "nick_name_new": "ç’æ‘æƒ‚é¢ã„¦åŸ›_0EJ1yMeé¦ƒæƒ¥",
    "tieba_uid": 0,
    "glevel": 0,
    "gender": 1,
    "age": 11.5,
    "post_num": 2768,
    "agree_num": 2,
    "fan_num": 47,
    "follow_num": 57,
    "forum_num": 28,
    "sign": "å¤§çˆ±å…­å…­",
    "ip": "",
    "icons": [],
    "vimage": { "enabled": false, "state": "" },
    "is_vip": false,
    "is_god": false,
    "is_blocked": false,
    "priv_like": 2,
    "priv_reply": 1
}
```

`è´´å§ç”¨æˆ·_06y9CQW`

```json
{
    "user_id": 568818738,
    "portrait": "tb.1.66a5b431.2vB54rBhK3J7pvxZ2Mc3ng",
    "user_name": "-",
    "nick_name_new": "è´´å§ç”¨æˆ·_06y9CQW",
    "tieba_uid": 37499515,
    "glevel": 0,
    "gender": 1,
    "age": 12.5,
    "post_num": 3665,
    "agree_num": 15,
    "fan_num": 43,
    "follow_num": 134,
    "forum_num": 17,
    "sign": "æˆ‘å°±æ˜¯æˆ‘ï¼Œä¸æ˜¯äº”æ¯›ä¸€ç›’çš„çƒŸç«ï¼Œï¼Œï¼Œï¼Œï¼Œ",
    "ip": "å®‰å¾½",
    "icons": [],
    "vimage": { "enabled": false, "state": "" },
    "is_vip": false,
    "is_god": false,
    "is_blocked": false,
    "priv_like": 3,
    "priv_reply": 1
}
```

**tieba_uid**

å¯èƒ½ä¸ºç©ºï¼Œ ä¹Ÿæ²¡ä»€ä¹ˆç”¨

### å¤´åƒ

ç›®å‰ç™¾åº¦è´´å§ç§»åŠ¨ç«¯ç”¨ `portrait` è¿™ä¸€å‚æ•°æ¥è¯·æ±‚å¤´åƒå›¾ç‰‡ã€‚

```powershell
# å°å¤´åƒ
 # t=$timestamp è¿™ä¸ªå‚æ•°æˆ‘çŒœæµ‹æ˜¯å¤´åƒä¿®æ”¹çš„æ—¶é—´
https://gss0.baidu.com/7Ls0a8Sm2Q5IlBGlnYG/sys/portrait/item/$portrait?t=$timestamp
http://tb.himg.baidu.com/sys/portrait/item/$portrait

# é«˜æ¸…å¤´åƒ
https://himg.bdimg.com/sys/portraith/item/$portrait
```

> è¦æ³¨æ„çš„æ˜¯ï¼Œä½ åœ¨ç½‘é¡µç«¯æµè§ˆå¸–å­æ—¶çœ‹åˆ°çš„ç”¨æˆ·å¤´åƒå¯èƒ½ä¼šä¸çˆ¬å–åˆ°çš„å›¾ç‰‡ä¸ä¸€æ ·ã€‚å› ä¸ºçˆ¬å–å¤´åƒä¾é çš„æ˜¯ `https://himg.bdimg.com/sys/portraith/item/$portrait` è¿™ä¸ªæ¥å£ã€‚ç½‘é¡µç«¯ç”±äºå…¶ç‰¹æ®Šçš„åŠ è½½æ–¹å¼å¯¼è‡´æœ‰äº›æœ‰å¹´ä»£çš„å¸–å­ä¼šåŠ è½½è¿‡æ—¶çš„å¤´åƒï¼ˆç”¨æˆ·ä»¥å‰çš„å¤´åƒï¼‰ã€‚

### level å’Œ glevel çš„åŒºåˆ«

level å§å†…ç­‰çº§

glevel è´´å§æˆé•¿ç­‰çº§

## å†…å®¹

### åˆ†å—ç¼–å·

```python
_type = proto.type
# 0çº¯æ–‡æœ¬ 9ç”µè¯å· 18è¯é¢˜ 27ç™¾ç§‘è¯æ¡ 40æ¢—ç™¾ç§‘
if _type in [0, 9, 18, 27, 40]:
    frag = FragText_p.from_tbdata(proto)
    texts.append(frag)
    yield frag
# 11:tid=5047676428
elif _type in [2, 11]:
    frag = FragEmoji_p.from_tbdata(proto)
    emojis.append(frag)
    yield frag
# 20:tid=5470214675
elif _type in [3, 20]:
    frag = FragImage_p.from_tbdata(proto)
    imgs.append(frag)
    yield frag
elif _type == 4:
    frag = FragAt_p.from_tbdata(proto)
    ats.append(frag)
    texts.append(frag)
    yield frag
elif _type == 1:
    frag = FragLink_p.from_tbdata(proto)
    links.append(frag)
    texts.append(frag)
    yield frag
elif _type == 10:  # voice
    frag = FragVoice_p.from_tbdata(proto)
    nonlocal voice
    voice = frag
    yield frag
elif _type == 5:  # video
    frag = FragVideo_p.from_tbdata(proto)
    nonlocal video
    video = frag
    yield frag
# 35|36:tid=7769728331 / 37:tid=7760184147
elif _type in [35, 36, 37]:
    frag = FragTiebaPlus_p.from_tbdata(proto)
    tiebapluses.append(frag)
    texts.append(frag)
    yield frag
# outdated tiebaplus
elif _type == 34:
    continue
```

### è¯­éŸ³

æ¯æ¡å¸–å­åªèƒ½å‘é€ä¸€æ¡è¯­éŸ³ã€‚

```json
{
    "voice": {
        "md5": "",
        "duration": 0
    }
}
```

è¯­éŸ³ä¸‹è½½åœ°å€

```powershell
https://tiebac.baidu.com/c/p/voice?voice_md5=$voice_md5&play_from=pb_voice_play
```

### AT åˆ†å—

at åˆ†å—æ˜¾ç¤ºçš„æ–‡å­—æ˜¯ç”¨æˆ·å½“æ—¶çš„ nickname. ä¸æ˜¯ username.

```python
FragAT(
    text='$nickname',
    user_id=0
)
```

### Emoji

```csharp
  const emoticonsIndex = {
        image_emoticon: { class: 'client', ext: 'png' }, // æ³¡æ³¡(<51)/å®¢æˆ·ç«¯æ–°ç‰ˆè¡¨æƒ…(>61)
        // image_emoticon: { class: 'face', ext: 'gif', prefix: 'i_f' }, // æ—§ç‰ˆæ³¡æ³¡
        'image_emoticon>51': { class: 'face', ext: 'gif', prefix: 'i_f' }, // æ³¡æ³¡-è´´å§åå‘¨å¹´(51>=i<=61)
        bearchildren_: { class: 'bearchildren', ext: 'gif' }, // è´´å§ç†Šå­©å­
        tiexing_: { class: 'tiexing', ext: 'gif' }, // ç—’å°è´±
        ali_: { class: 'ali', ext: 'gif' }, // é˜¿ç‹¸
        llb_: { class: 'luoluobu', ext: 'gif' }, // ç½—ç½—å¸ƒ
        b: { class: 'qpx_n', ext: 'gif' }, // æ°”æ³¡ç†Š
        xyj_: { class: 'xyj', ext: 'gif' }, // å°å¹ºé¸¡
        ltn_: { class: 'lt', ext: 'gif' }, // å†·å…”
        bfmn_: { class: 'bfmn', ext: 'gif' }, // ç™½å‘é­”å¥³
        pczxh_: { class: 'zxh', ext: 'gif' }, // å¼ å°ç›’
        t_: { class: 'tsj', ext: 'gif' }, // å…”æ–¯åŸº
        wdj_: { class: 'wdj', ext: 'png' }, // è±Œè±†èš
        lxs_: { class: 'lxs', ext: 'gif' }, // å†·å…ˆæ£®
        B_: { class: 'bobo', ext: 'gif' }, // æ³¢æ³¢
        yz_: { class: 'shadow', ext: 'gif' }, // å½±å­
        w_: { class: 'ldw', ext: 'gif' }, // ç»¿è±†è›™
        '10th_': { class: '10th', ext: 'gif' } // è´´å§åå‘¨å¹´
    } as const;
```

## Post

### æ–‡ä»¶å”¯ä¸€æ ‡è¯†

ç›®å‰æ¥çœ‹è´´å§åº”è¯¥ç”¨æ˜¯ md5

### IP å±åœ°

è´´å§ä¸æ˜¯æ¯ä¸ªå¸–å­éƒ½ä¿å­˜å‘å¸ƒæ—¶çš„ ip åœ°å€ã€‚ä¼šéšç€ç”¨æˆ·çš„ ip æ”¹å˜

æœ‰äº›æ²¡æœ‰ä¸€ç›´æ²¡ç™»é™†çš„ç”¨æˆ·çˆ¬ä¸å‡º ipã€‚

### reply_num

åªä¼šå¢åŠ ã€‚ä¸ä¼šå‡å°‘ã€‚

åˆ é™¤æ¥¼ä¸­æ¥¼ï¼Œä¸ä¼šå‡å°‘ reply_num çš„å€¼ã€‚

### è¯é¢˜

è¯é¢˜æ˜¯çº¯æ–‡æœ¬ã€‚ç”¨##åŒ…è£¹ï¼Œ

ç”¨ç™¾åº¦çš„ api å»æœç´¢ã€‚

### è§†é¢‘

æ¯æ¡è´´å­åªèƒ½å‘ä¸€æ¡è§†é¢‘ã€‚

```json
{
    "video": {
        "src": "",
        "cover_src": "",
        "duration": 0,
        "width": 0,
        "height": 0,
        "view_num": 0
    }
}
```

### tiebapluse

æˆ‘ä¸çŸ¥é“è¿™æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œæ²¡è§è¿‡ã€‚

### å°å°¾å·´ sign

å·²ç»å‘å¸ƒçš„å°å°¾å·´ä¸ä¼šéšç€ç”¨æˆ·ä¿®æ”¹å°å°¾å·´è€Œæ”¹å˜ã€‚

### è®¾å¤‡ ï¼ˆæ— ï¼‰

ç½‘é¡µç«¯ä¼šæ˜¾ç¤ºè®¾å¤‡ï¼Œä½†æ˜¯ç§»åŠ¨ç«¯ api æ²¡æœ‰è®¾å¤‡ä¿¡æ¯ã€‚

![1717232574390](./assets/tieba_data_notes/images/1717232574390.png)

### è‡ªå®šä¹‰å¡«å­—è¡¨æƒ…åŒ…

## Comments(sub-post)

ç»“æ„ä¸ post åŸºæœ¬ç›¸ä¼¼

### è¢«å›å¤è€…(reply_to)

è´´å§è¡¨è¾¾è¢«å›å¤è€…æœ‰ä¸‰ç§æ–¹å¼

**1. æŠŠè¢«å›å¤è€…çš„æ˜µç§°å†™å…¥ contents çš„ FragText**

æ—©æœŸå¸–å­çš„æ–¹å¼ã€‚

ç›´æ¥æŠŠè¢«å›å¤è€…çš„ `æ˜µç§°(nickname)` åµŒå…¥åˆ°æ–‡æœ¬åˆ†å—ä¸­, å¤ªè‰äº†ç”¨çš„æ˜µç§°ï¼Œå¥½æ­¹ç”¨ç”¨æˆ·åå‘¢ï¼Œæˆ‘éƒ½æ²¡åŠæ³•ä¿®å¤æ•°æ®ã€‚

```json
å›å¤ $nickname :
```

**2. å†™å…¥ contents çš„ FragText å’Œ FragAT**

æ—©æœŸå¸–å­çš„æ–¹å¼ã€‚ä½¿ç”¨ FragText å’Œ FragAt é…åˆä½¿ç”¨ã€‚

```powershell
Contents(
    objs=[
        FragText(
            text='å›å¤ '
        ),
        FragAT(
            text='$nickname',
            user_id=0
        )
        FragText(
            text=' :'
        ),
    ]
)
```

**3. ä½¿ç”¨ reply_to_id å­—æ®µ**

ç›®å‰å®˜æ–¹ä½¿ç”¨çš„æ–¹æ³•ã€‚ç”¨ reply_to_id å±æ€§è¡¨æ˜å›å¤è€…ã€‚

ä¸‹é¢æ˜¯æ—¢æœ‰ reply_to_id ä¹ŸæŠŠè¢«å›å¤è€…å½“æ—¶çš„æ˜µç§°ç»™åµŒå…¥åˆ°äº†å¸–å­å†…å®¹æ—¶çš„æŠ½è±¡æ˜¾ç¤ºã€‚

![1721378398134](./assets/tieba_data_notes/images/1721378398134.png)

## Thead

### è½¬å‘è´´(share_origin)

è½¬å‘è´´ä¸èƒ½åµŒå¥—ã€‚

åªèƒ½ä¸¤å±‚ã€‚å…¶ä»–è½¬å‘è´´å§‹ç»ˆæŒ‡å‘çš„æ˜¯ç¬¬ä¸€å±‚çš„åŸå¸–ã€‚

```json
{
    "share_origin": {
        "contents": {
            "objs": [],
            "texts": [],
            "emojis": [],
            "imgs": [],
            "ats": [],
            "links": [],
            "tiebapluses": [],
            "video": {
                "src": "",
                "cover_src": "",
                "duration": 0,
                "width": 0,
                "height": 0,
                "view_num": 0
            },
            "voice": {
                "md5": "",
                "duration": 0
            }
        },
        "title": "",
        "fid": 0,
        "fname": "",
        "tid": 0,
        "author_id": 0,
        "vote_info": {
            "title": "",
            "is_multi": false,
            "options": [],
            "total_vote": 0,
            "total_user": 0
        }
    }
}
```

### æŠ•ç¥¨

```json
{
    "vote_info": {
        "title": "t",
        "is_multi": false,
        "options": [
            {
                "vote_num": 1488,
                "text": "t1"
            },
            {
                "vote_num": 304,
                "text": "t2"
            }
        ],
        "total_vote": 1792,
        "total_user": 1792
    }
}
```
